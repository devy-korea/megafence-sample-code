
<!DOCTYPE html>
<html>
<!--
landing Page 샘플입니다.
컨텐츠는 업무에 맞게 보완해 주세요.
코드는 TODO-XX 표시한 부분 수정해 주세요.
-->
<head>

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- begin of 고객사 META TAG-->
    <meta name="robots" content="noindex,nofollow">
    <!-- favicon : hoam -->
    <!-- Open Graph : hoam -->
    <!-- end of 고객사 META TAG-->


    <link href="https://dist.devy.kr/bulma/0.7.1/bulma.css" rel="stylesheet" />
    <style>
        body {
            height: 100vh;
            background-color: white;
            /*background-image: url(img/background-pc.jpg?v=1);*/
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            overflow-y: hidden;
        }

        /* remove vertical scroll bar */
        html, body {
            overflow-y: scroll; /* Ensures content can still scroll */
            scrollbar-width: none; /* Firefox */
            -ms-overflow-style: none; /* IE & Edge */
        }

            body::-webkit-scrollbar {
                display: none; /* Chrome, Safari, Edge */
            }

        #loading {
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: white;
            z-index: 999999;
            overflow: hidden;
        }

            #loading div.content {
                position: absolute;
                left: 50%;
                top: 50%;
                transform: translate(-50%, -50%);
            }

                #loading div.content img {
                    width: 8rem;
                    height: 8rem;
                }
    </style>


</head>
<body>
    <div id="loading">
        <div class="content">
            <img src="https://cdn2.devy.kr/9000/img/loading.gif" />
        </div>
    </div>
    <div id="app" class="container has-text-centered">
    </div>


    <!-- begin of megafence -------------------------------------------->
    <!-- TODO-1 : webgate.js 경로의 9000 대신 할당된 SERVICE ID로 수정-->
    <script src="https://cdn2.devy.kr/9000/js/webgate.js?v=250717a"></script>
    <script src="https://dist.devy.kr/utils/sweetalert2-11.22.2.js"></script>
    <script>
        var _gateId = "4";  // SET your default gate id
        var _nextUrl = "backend_with_landing.php"; // SET your default next page


        function WG_PageLoaded() {
            _gateId = $WG.getParam("GateId") || _gateId;
            _nextUrl = decodeURIComponent($WG.getParam("NextUrl")) || _nextUrl;

            if ($WG.getParam("IsDevTest") == "Y") {
                // nothing to do
                alert("DEV-TEST : 소스 보기용");
            }
            else {
                // auto start
                if (_gateId)
                    startWebGate(_gateId, _nextUrl);
                else {
                    alert("GateId paramter 누락")
                }
            }
        }

        function startWebGate(gateId, nextUrl) {
            gateId = gateId + "";

            if (!gateId) {
                Swal.fire({
                    title: '',
                    text: "잘못된 호출입니다.",
                    icon: '', //'warning',
                    confirmButtonText: '확인'
                })
                return;
            }
            // NextUrl 없이 GateId만 호출된 경우 NextUrl Default 처리
            if (gateId && !nextUrl) {
                switch (gateId) {
                    default:
                        nextUrl = "/";
                        break;
                }
            }

            var config = {
                gateId: gateId,                     // GATE-ID
                uiMode: "BACKEND",                  // FRONTEND : 대기취소버튼 표시, BACKEND : 대기취소버튼 미표시
                topTitle: "서비스 접속 대기 중",    // 대기UI 제목
                uiShowDelay: 0 * 1000,              // 대기UI 표시 지연시간(ms)
                uiHideDelay: 10 * 1000,             // 대기 종료 후 대기UI 감추기 지연시간(ms)
                resetForce: false,                  // 대기표 강제초기화. true:실행시마다 대기표 강제발급, false:유효한 내 대기표가 있으면 사용
                customType: "",                     // UI 분기 변경 필요 시
                onSuccess: function (data) {
                    //console.log("onSuccess", data);
                    var res = $WG.lastResponse;
                    if (res.GateOperationMode == "ALERT") {
                        // 유입차단 기간인 경우 (동작 스케쥴 세팅은 데브와이가 함)
                        if (res.GateOperationMessageTitle == "NOT_OPEN") {
                            $WG.setCookie("WG_TOKEN_NO", "");
                            Swal.fire({
                                title: '',
                                html: res.GateOperationMessageDetail.replaceAll('\n', '<br/>'),
                                icon: '', //'warning',
                                confirmButtonText: '확인'
                            })
                        }
                    } else if (res.GateOperationMode == "GATE") {
                        WG_ChangeUrl(nextUrl);
                    }
                },
                // 매크로 판정 시 처리
                onMdsDetected: function (data) { 
                    //console.log("onMdsFail", data);
                    if (typeof turnstile != "undefined" && turnstile != null) {
                        turnstile.reset();
                    }
                    var msg = "매크로 등에 의한 부정접속 시도가 감지되었습니다.\n만일 '사람인지 확인하십시오' 문구가 화면에 표시되었다면 확인란을 체크하신 후 다시 시도해 보시기 바랍니다.";
                    if (data.ResultMessage == "MDS_FAIL_BLOCKED_IP") {
                        msg = "접속 차단된 IP입니다.\n다른 IP에서 접속하거나 관리자에게 문의 주시기 바랍니다.";
                    }
                    Swal.mixin({
                        customClass: {
                            confirmButton: "button is-black",
                            cancelButton: "button is-danger"
                        },
                        buttonsStyling: false
                    }).fire({
                        title: '',
                        width: 640,
                        padding: "2rem 0rem",
                        html: msg.replaceAll('\n', '<br/>'),
                        icon: '', //'warning',
                        confirmButtonText: '확인'
                    })
                    return;
                },
                onAlert: function (data) {
                    alert(res.GateOperationMessageDetail);
                },
                onWaiting: function (data) {
                },
                onFail: function (data) { // 유량제어 서비스 장애 시 처리
                    alert("죄송합니다. 잠시 후 다시 시도해 주세요");
                },
                onFinally: function () {
                    document.getElementById("loading").style.display = "none";
                }
            };
            WG_StartWebGate(config);
        }
    </script>
    <!-- end of megafence ---------------------------------------------->

</body>
</html>
